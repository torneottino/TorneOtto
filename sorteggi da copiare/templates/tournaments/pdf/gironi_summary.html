<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ tournament.nome }} - Giornata del {{ data }}</title>
    <style>
        @page {
            size: A4 portrait;
            margin: 1cm;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            font-size: 10pt;
            padding-bottom: 2cm;
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #007bff;
            padding-bottom: 5px;
        }
        
        h1 {
            color: #007bff;
            margin: 0;
            font-size: 16pt;
        }
        
        h2 {
            color: #666;
            margin: 3px 0;
            font-size: 12pt;
        }
        
        .date {
            font-size: 10pt;
            font-style: italic;
            margin: 5px 0;
            color: #666;
        }
        
        .method {
            font-size: 9pt;
            color: #666;
            margin: 5px 0;
        }
        
        .section-title {
            color: #007bff;
            font-size: 13pt;
            font-weight: bold;
            text-align: center;
            margin: 22px 0 13px 0;
            letter-spacing: 0.5px;
        }
        
        .section-title:first-of-type {
            margin-top: 0;
        }
        
        .gironi-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .gironi-row {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            margin: 15px 0 15px 0;
        }
        
        .girone-card {
            flex: 1 1 0;
            min-width: 0;
            background: #fff;
            border: 1px solid #007bff;
            border-radius: 8px;
            margin: 0 2px;
            padding: 6px 4px 6px 4px;
            box-sizing: border-box;
            text-align: center;
        }
        
        .girone-header {
            color: #007bff;
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .girone-team {
            font-size: 10pt;
            margin: 1px 0;
        }
        
        .matches-section {
            margin-top: 30px;
        }
        
        .matches-title {
            color: #007bff;
            font-size: 13pt;
            font-weight: bold;
            text-align: center;
            margin: 22px 0 13px 0;
            letter-spacing: 0.5px;
        }
        
        .girone-matches {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .girone-matches-header {
            color: #007bff;
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            padding: 5px;
            border: 2px solid #007bff;
            border-radius: 5px;
            background: rgba(0, 123, 255, 0.07);
        }
        
        .match-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 6px 0;
            padding: 6px;
            background: #fff;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        
        .match-teams {
            flex: 1;
            text-align: center;
            font-size: 10pt;
        }
        
        .vs {
            color: #666;
            font-weight: bold;
            margin: 0 8px;
            font-size: 9pt;
        }
        
        .result-box {
            width: 60px;
            height: 20px;
            border: 1px solid #007bff;
            border-radius: 3px;
            margin-left: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9pt;
            color: #007bff;
            background: #fff;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 8pt;
            color: #666;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ tournament.nome }}</h1>
        {% if tournament.circolo %}
        <h2>{{ tournament.circolo }}</h2>
        {% endif %}
        <div class="date">Giornata del {{ data }}</div>
        <div class="method">Metodo: 
            {% if metodo == 'casuale' %}Totalmente Casuale
            {% elif metodo == 'elo' %}Per ELO e Posizione
            {% elif metodo == 'seeded' %}Teste di Serie
            {% elif metodo == 'manuale' %}Manuale
            {% endif %}
        </div>
    </div>

    <!-- Sezione GIRONI -->
    <div class="section-title">GIRONI</div>
    
    {% set gironi_per_row = 3 %}
    {% for row_start in range(0, gironi|length, gironi_per_row) %}
    <div class="gironi-row">
        {% for i in range(row_start, [row_start + gironi_per_row, gironi|length]|min) %}
        {% set girone = gironi[i] %}
        <div class="girone-card">
            <div class="girone-header">Girone {{ i + 1 }}</div>
            {% for team in girone %}
            <div class="girone-team">
                {{ team[0].cognome }} - {{ team[1].cognome }}
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% endfor %}

    <!-- Sezione PARTITE -->
    <div class="matches-section">
        <div class="matches-title">PROGRAMMA DELLE PARTITE</div>
        
        {% for girone in gironi %}
        <div class="girone-matches">
            <div class="girone-matches-header">Partite Girone {{ loop.index }}</div>
            
            {% set teams_in_girone = girone %}
            {% set num_teams = teams_in_girone|length %}
            
            {# Simulazione semplificata della turnazione - mostra le partite divise per turno #}
            {% if num_teams == 3 %}
                <div style="font-weight: bold; color: #666; margin: 10px 0 5px 0; font-size: 10pt;">Turno 1:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[0][0].cognome }} {{ teams_in_girone[0][0].nome }} / {{ teams_in_girone[0][1].cognome }} {{ teams_in_girone[0][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[1][0].cognome }} {{ teams_in_girone[1][0].nome }} / {{ teams_in_girone[1][1].cognome }} {{ teams_in_girone[1][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div style="font-weight: bold; color: #666; margin: 15px 0 5px 0; font-size: 10pt;">Turno 2:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[0][0].cognome }} {{ teams_in_girone[0][0].nome }} / {{ teams_in_girone[0][1].cognome }} {{ teams_in_girone[0][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[2][0].cognome }} {{ teams_in_girone[2][0].nome }} / {{ teams_in_girone[2][1].cognome }} {{ teams_in_girone[2][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div style="font-weight: bold; color: #666; margin: 15px 0 5px 0; font-size: 10pt;">Turno 3:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[1][0].cognome }} {{ teams_in_girone[1][0].nome }} / {{ teams_in_girone[1][1].cognome }} {{ teams_in_girone[1][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[2][0].cognome }} {{ teams_in_girone[2][0].nome }} / {{ teams_in_girone[2][1].cognome }} {{ teams_in_girone[2][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
            {% elif num_teams == 4 %}
                <div style="font-weight: bold; color: #666; margin: 10px 0 5px 0; font-size: 10pt;">Turno 1:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[0][0].cognome }} {{ teams_in_girone[0][0].nome }} / {{ teams_in_girone[0][1].cognome }} {{ teams_in_girone[0][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[3][0].cognome }} {{ teams_in_girone[3][0].nome }} / {{ teams_in_girone[3][1].cognome }} {{ teams_in_girone[3][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[1][0].cognome }} {{ teams_in_girone[1][0].nome }} / {{ teams_in_girone[1][1].cognome }} {{ teams_in_girone[1][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[2][0].cognome }} {{ teams_in_girone[2][0].nome }} / {{ teams_in_girone[2][1].cognome }} {{ teams_in_girone[2][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div style="font-weight: bold; color: #666; margin: 15px 0 5px 0; font-size: 10pt;">Turno 2:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[0][0].cognome }} {{ teams_in_girone[0][0].nome }} / {{ teams_in_girone[0][1].cognome }} {{ teams_in_girone[0][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[2][0].cognome }} {{ teams_in_girone[2][0].nome }} / {{ teams_in_girone[2][1].cognome }} {{ teams_in_girone[2][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[3][0].cognome }} {{ teams_in_girone[3][0].nome }} / {{ teams_in_girone[3][1].cognome }} {{ teams_in_girone[3][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[1][0].cognome }} {{ teams_in_girone[1][0].nome }} / {{ teams_in_girone[1][1].cognome }} {{ teams_in_girone[1][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div style="font-weight: bold; color: #666; margin: 15px 0 5px 0; font-size: 10pt;">Turno 3:</div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[0][0].cognome }} {{ teams_in_girone[0][0].nome }} / {{ teams_in_girone[0][1].cognome }} {{ teams_in_girone[0][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[1][0].cognome }} {{ teams_in_girone[1][0].nome }} / {{ teams_in_girone[1][1].cognome }} {{ teams_in_girone[1][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
                <div class="match-item">
                    <div class="match-teams">
                        {{ teams_in_girone[2][0].cognome }} {{ teams_in_girone[2][0].nome }} / {{ teams_in_girone[2][1].cognome }} {{ teams_in_girone[2][1].nome }}
                        <span class="vs">VS</span>
                        {{ teams_in_girone[3][0].cognome }} {{ teams_in_girone[3][0].nome }} / {{ teams_in_girone[3][1].cognome }} {{ teams_in_girone[3][1].nome }}
                    </div>
                    <div class="result-box">__ - __</div>
                </div>
            {% else %}
                {# Fallback per altri numeri di squadre #}
                {% for i in range(num_teams) %}
                    {% for j in range(i+1, num_teams) %}
                    <div class="match-item">
                        <div class="match-teams">
                            {{ teams_in_girone[i][0].cognome }} {{ teams_in_girone[i][0].nome }} / {{ teams_in_girone[i][1].cognome }} {{ teams_in_girone[i][1].nome }}
                            <span class="vs">VS</span>
                            {{ teams_in_girone[j][0].cognome }} {{ teams_in_girone[j][0].nome }} / {{ teams_in_girone[j][1].cognome }} {{ teams_in_girone[j][1].nome }}
                        </div>
                        <div class="result-box">__ - __</div>
                    </div>
                    {% endfor %}
                {% endfor %}
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <div class="footer">
        <p>Generato automaticamente da TorneOtto - {{ now.strftime("%d/%m/%Y alle %H:%M") }}</p>
    </div>
</body>
</html> 