{% extends "base.html" %}

{% block head_extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/templates/eliminazione.css') }}">
    <style>
        body {
            background-color: #191a1c;
            color: #ffffff;
        }
        
        .container {
            padding: 10px;
            max-width: 800px;
            margin: auto;
        }

        .matches-container {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin: 5px 0;
            align-items: center;
            transition: all 0.3s ease;
        }

        .match-card {
            background: #27282c;
            border-radius: 6px;
            padding: 5px;
            border: 1px solid #444;
            width: 330px;
            margin: 5px auto;
            transition: all 0.3s ease;
            position: relative;
            overflow: visible;
        }

        .match-card:hover {
            border-color: #53a551;
        }

        .match-header {
            color: #53a551;
            font-size: 0.8rem;
            font-weight: 600;
            margin: 5px 0;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .match-result {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .team-row {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 3px 8px;
            border-radius: 6px;
            background: #191a1c;
            transition: all 0.3s ease;
            margin: 2px 0;
            min-height: 30px;
        }

        .team-row.winner {
            background: #53a551;
            border: 1px solid #68b366;
            transform: scale(1.02);
            color: white;
            box-shadow: 0 2px 8px rgba(83, 165, 81, 0.3);
        }

        .team-name {
            flex: 1;
            color: var(--text-primary);
            font-size: 0.8rem;
            font-weight: normal;
        }

        .team-row.winner .team-name {
            color: white;
            font-weight: 700;
        }

        .score-separator {
            color: #666;
            font-weight: 600;
            font-size: 1rem;
            margin: 0 5px;
        }

        .vs-row {
            color: #666;
            font-weight: 600;
            text-align: center;
            margin: 2px 0;
            font-size: 0.8rem;
        }

        .score-input {
            width: 50px;
            height: 30px;
            padding: 2px 4px;
            border: 1px solid #444;
            border-radius: 6px;
            background: #101112;
            color: #ffd700;
            text-align: center;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.2s ease;
            margin: 0;
            -moz-appearance: textfield;
        }
        
        .score-input::-webkit-outer-spin-button,
        .score-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .score-input:focus {
            border-color: #53a551;
            outline: none;
            box-shadow: 0 0 0 3px rgba(83, 165, 81, 0.2);
        }

        /* Stili specifici per best of 3 */
        .best-of-three-container {
            background: #232426;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
        }

        .best-of-three-header {
            color: #ffd700;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 8px;
        }

        .sets-container {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .set-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 3px 5px;
            background: #191a1c;
            border-radius: 4px;
        }

        .set-label {
            color: #ccc;
            font-size: 0.7rem;
            font-weight: 500;
            min-width: 40px;
        }

        .set-inputs {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .set-score-input {
            width: 40px;
            height: 25px;
            padding: 2px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #101112;
            color: #ffd700;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .set-score-input:focus {
            border-color: #53a551;
            outline: none;
        }



        /* NUOVO LAYOUT MIGLIORATO PER I SET */
        .teams-sets-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 10px 0;
        }

        .team-sets-row {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 8px;
            background: #191a1c;
            border-radius: 6px;
            border: 1px solid #444;
            transition: all 0.3s ease;
        }

        .team-sets-row.winner {
            background: #53a551;
            border-color: #68b366;
            color: white;
            box-shadow: 0 2px 8px rgba(83, 165, 81, 0.3);
        }

        .team-name-sets {
            flex: 1;
            font-weight: normal;
            color: #ffffff;
            min-width: 120px;
        }

        .team-sets-row.winner .team-name-sets {
            color: white;
        }

        .sets-inputs-row {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .set-input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }

        .set-input-group label {
            font-size: 0.7rem;
            font-weight: 600;
            color: #ffd700;
            margin-bottom: 2px;
        }

        .set-input-group .set-score-input {
            width: 40px;
            height: 30px;
        }

        .final-score-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 8px;
            padding: 5px;
            background: #2a2a2a;
            border-radius: 4px;
        }

        .final-score-label {
            color: #ffd700;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .final-score-display {
            color: #53a551;
            font-size: 0.9rem;
            font-weight: 700;
            padding: 2px 8px;
            background: #191a1c;
            border-radius: 4px;
            min-width: 40px;
            text-align: center;
        }

        .confirm-button {
            width: 250px;
            padding: 4px 8px;
            border: none;
            border-radius: 6px;
            background: linear-gradient(135deg, #53a551, #4a9449);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px auto;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            height: 28px;
        }

        .confirm-button:hover {
            background: linear-gradient(135deg, #4a9449, #53a551);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(83, 165, 81, 0.3);
        }

        .page-title {
            color: #ffffff;
            font-size: 1rem;
            font-weight: 700;
            text-align: center;
            margin-top: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        /* Stile per bye matches */
        .bye-match {
            border-color: #f39c12;
            background: rgba(243, 156, 18, 0.1);
        }

        .bye-match .match-header {
            color: #f39c12;
        }
        
        .bye-info {
            text-align: center;
            padding: 8px 10px;
            color: #f39c12;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .no-matches {
            margin-top: 10px;
            margin-bottom: 10px;
            padding: 8px 10px;
        }

        .button-container {
            margin-top: 20px;
            margin-bottom: 100px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            width: 270px;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            text-decoration: none;
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: #53a551;
            color: white;
        }

        .btn-primary:hover {
            background: #4a9449;
            color: white;
        }

        .btn-secondary {
            background: #444444;
            color: white;
        }

        .btn-secondary:hover {
            background: #333333;
            color: white;
        }

    </style>
{% endblock %}

{% block content %}
<div class="container">
    <h1 class="page-title">
        <i class="fas fa-trophy" style="color: #ffd700;"></i>
        Inserimento Risultati - DirettoElimina
    </h1>

    {% if matches_with_info %}
        <div class="matches-container">
            {% for match_info in matches_with_info %}
                {% if match_info.is_bye %}
                    <!-- Partita BYE -->
                    <div class="match-card bye-match">
                        <div class="match-header">
                            <i class="fas fa-forward"></i>
                            {{ match_info.match_title }}
                        </div>
                        <div class="bye-info">
                            {% if match_info.match.team1 and match_info.match.team1.is_bye %}
                                <strong>{{ match_info.match.team2.get_display_name() }}</strong> passa automaticamente.
                            {% elif match_info.match.team2 and match_info.match.team2.is_bye %}
                                <strong>{{ match_info.match.team1.get_display_name() }}</strong> passa automaticamente.
                            {% else %}
                                BYE passa automaticamente
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <!-- Partita normale -->
                    <div class="match-card" id="match-card-{{ match_info.match.id }}">
                        <div class="match-header">
                            <i class="fas fa-play-circle"></i>
                            {{ match_info.match_title }}
                        </div>
                        
                        {% if elim_tournament.best_of_three %}
                            <!-- Template per best of 3 set -->
                            <div class="best-of-three-container">
                                <div class="best-of-three-header">
                                    Partita al meglio dei 3 set
                                </div>
                                

                                
                                <div class="teams-sets-container">
                                    <!-- SQUADRA 1 con i suoi set -->
                                    <div class="team-sets-row" id="team1-sets-row-{{ match_info.match.id }}">
                                        <span class="team-name-sets">{{ match_info.match.team1.get_display_name() if match_info.match.team1 else 'Squadra 1' }}</span>
                                        <div class="sets-inputs-row">
                                            <div class="set-input-group">
                                                <label>SET1</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set1_team1_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                            <div class="set-input-group">
                                                <label>SET2</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set2_team1_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                            <div class="set-input-group">
                                                <label>SET3</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set3_team1_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- SQUADRA 2 con i suoi set -->
                                    <div class="team-sets-row" id="team2-sets-row-{{ match_info.match.id }}">
                                        <span class="team-name-sets">{{ match_info.match.team2.get_display_name() if match_info.match.team2 else 'Squadra 2' }}</span>
                                        <div class="sets-inputs-row">
                                            <div class="set-input-group">
                                                <label>SET1</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set1_team2_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                            <div class="set-input-group">
                                                <label>SET2</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set2_team2_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                            <div class="set-input-group">
                                                <label>SET3</label>
                                                <input type="number" 
                                                       class="set-score-input" 
                                                       id="set3_team2_{{ match_info.match.id }}" 
                                                       min="0" 
                                                       max="30"
                                                       placeholder="0"
                                                       onchange="updateFinalScore({{ match_info.match.id }})">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="final-score-container">
                                    <span class="final-score-label">Risultato finale:</span>
                                    <span class="final-score-display" id="final-score-{{ match_info.match.id }}">0-0</span>
                                </div>
                            </div>
                        {% else %}
                            <!-- Template per partita singola -->
                            <div class="match-result">
                                <div class="team-row" id="team1-row-{{ match_info.match.id }}">
                                    <span class="team-name">{{ match_info.match.team1.get_display_name() if match_info.match.team1 else 'Squadra 1' }}</span>
                                    <span class="score-separator">-</span>
                                    <input type="number" 
                                           class="score-input" 
                                           id="team1_score_{{ match_info.match.id }}" 
                                           min="0" 
                                           max="99"
                                           value=""
                                           placeholder="0">
                                </div>
                                
                                <div class="vs-row">VS</div>
                                
                                <div class="team-row" id="team2-row-{{ match_info.match.id }}">
                                    <span class="team-name">{{ match_info.match.team2.get_display_name() if match_info.match.team2 else 'Squadra 2' }}</span>
                                    <span class="score-separator">-</span>
                                    <input type="number" 
                                           class="score-input" 
                                           id="team2_score_{{ match_info.match.id }}" 
                                           min="0" 
                                           max="99"
                                           value=""
                                           placeholder="0">
                                </div>
                            </div>
                        {% endif %}
                        
                        <button type="button" 
                                class="confirm-button" 
                                onclick="confirmResult({{ match_info.match.id }}, {{ match_info.match.team1_id if match_info.match.team1_id else 'null' }}, {{ match_info.match.team2_id if match_info.match.team2_id else 'null' }})">
                            <i class="fas fa-check-circle"></i>
                            CONFERMA RISULTATI
                        </button>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% else %}
        <div class="no-matches">
            <i class="fas fa-check-circle" style="color: #28a745; font-size: 3em; margin-bottom: 1em;"></i>
            <p><strong>Tutte le partite del turno corrente sono state completate!</strong></p>
            <p>Procedi alla visualizzazione del tabellone per vedere i risultati.</p>
        </div>
    {% endif %}

    <div class="button-container">
        <a href="{{ url_for('tournaments.elimination_view_bracket', tournament_id=tournament.id) }}" class="btn btn-primary">
            <i class="fas fa-sitemap"></i>
            Visualizza Tabellone
        </a>
        
        <a href="{{ url_for('tournaments.view_tournament', tournament_id=tournament.id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i>
            Torna al Torneo
        </a>
    </div>
</div>

<!-- Banner per messaggi (da script) -->
<div id="message-banner" class="message-banner" style="display:none; position: fixed; top: 20px; right: 20px; background: #238636; color: white; padding: 15px 20px; border-radius: 8px; font-size: 1em; font-weight: 600; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.2); transition: all 0.3s ease;">
    <i class="fas fa-check-circle" style="margin-right: 10px;"></i>
    <span id="banner-text"></span>
</div>

<script>
function updateFinalScore(matchId) {
    const isBestOfThree = {{ elim_tournament.best_of_three|tojson }};
    if (!isBestOfThree) return;
    
    // Ottieni i punteggi dei set
    const set1Team1 = parseInt(document.getElementById('set1_team1_' + matchId).value) || 0;
    const set1Team2 = parseInt(document.getElementById('set1_team2_' + matchId).value) || 0;
    const set2Team1 = parseInt(document.getElementById('set2_team1_' + matchId).value) || 0;
    const set2Team2 = parseInt(document.getElementById('set2_team2_' + matchId).value) || 0;
    const set3Team1 = parseInt(document.getElementById('set3_team1_' + matchId).value) || 0;
    const set3Team2 = parseInt(document.getElementById('set3_team2_' + matchId).value) || 0;
    
    // Calcola i set vinti da ogni squadra
    let team1Sets = 0;
    let team2Sets = 0;
    
    if (set1Team1 > 0 || set1Team2 > 0) {
        if (set1Team1 > set1Team2) team1Sets++;
        else if (set1Team2 > set1Team1) team2Sets++;
    }
    
    if (set2Team1 > 0 || set2Team2 > 0) {
        if (set2Team1 > set2Team2) team1Sets++;
        else if (set2Team2 > set2Team1) team2Sets++;
    }
    
    if (set3Team1 > 0 || set3Team2 > 0) {
        if (set3Team1 > set3Team2) team1Sets++;
        else if (set3Team2 > set3Team1) team2Sets++;
    }
    
    // Aggiorna il display del risultato finale
    const finalScoreDisplay = document.getElementById('final-score-' + matchId);
    finalScoreDisplay.textContent = team1Sets + '-' + team2Sets;
    
    // Aggiorna lo stile delle righe del team - NUOVO LAYOUT
    const team1Row = document.getElementById('team1-sets-row-' + matchId) || document.getElementById('team1-row-' + matchId);
    const team2Row = document.getElementById('team2-sets-row-' + matchId) || document.getElementById('team2-row-' + matchId);
    
    if (team1Row) team1Row.classList.remove('winner');
    if (team2Row) team2Row.classList.remove('winner');
    
    if (team1Sets > team2Sets && team1Sets >= 2) {
        if (team1Row) team1Row.classList.add('winner');
    } else if (team2Sets > team1Sets && team2Sets >= 2) {
        if (team2Row) team2Row.classList.add('winner');
    }
}

function confirmResult(matchId, team1Id, team2Id) {
    const isBestOfThree = {{ elim_tournament.best_of_three|tojson }};
    
    let team1Score, team2Score, setScores = null;
    
    if (isBestOfThree) {
        // Ottieni i punteggi dei set
        const set1Team1 = parseInt(document.getElementById('set1_team1_' + matchId).value) || 0;
        const set1Team2 = parseInt(document.getElementById('set1_team2_' + matchId).value) || 0;
        const set2Team1 = parseInt(document.getElementById('set2_team1_' + matchId).value) || 0;
        const set2Team2 = parseInt(document.getElementById('set2_team2_' + matchId).value) || 0;
        const set3Team1 = parseInt(document.getElementById('set3_team1_' + matchId).value) || 0;
        const set3Team2 = parseInt(document.getElementById('set3_team2_' + matchId).value) || 0;
        
        // Valida i punteggi dei set
        if ((set1Team1 === 0 && set1Team2 === 0) || (set2Team1 === 0 && set2Team2 === 0)) {
            showBanner('Devi inserire almeno i primi 2 set!', 'error');
            return;
        }
        
        // Calcola i set vinti
        let team1Sets = 0;
        let team2Sets = 0;
        
        if (set1Team1 > set1Team2) team1Sets++; else team2Sets++;
        if (set2Team1 > set2Team2) team1Sets++; else team2Sets++;
        if (set3Team1 > 0 || set3Team2 > 0) {
            if (set3Team1 > set3Team2) team1Sets++; else team2Sets++;
        }
        
        // Verifica che qualcuno abbia vinto 2 set
        if (team1Sets < 2 && team2Sets < 2) {
            showBanner('Uno dei due team deve vincere almeno 2 set!', 'error');
            return;
        }
        
        team1Score = team1Sets;
        team2Score = team2Sets;
        setScores = [[set1Team1, set1Team2], [set2Team1, set2Team2]];
        if (set3Team1 > 0 || set3Team2 > 0) {
            setScores.push([set3Team1, set3Team2]);
        }
    } else {
        // Partita singola
        team1Score = parseInt(document.getElementById('team1_score_' + matchId).value) || 0;
        team2Score = parseInt(document.getElementById('team2_score_' + matchId).value) || 0;
        
        if (team1Score === team2Score) {
            showBanner('I punteggi non possono essere uguali!', 'error');
            return;
        }
        
        if (team1Score < 0 || team2Score < 0) {
            showBanner('I punteggi non possono essere negativi!', 'error');
            return;
        }
    }
    
    // Cerca gli elementi del team per entrambi i layout (singolo e best of 3)
    const team1Row = document.getElementById('team1-sets-row-' + matchId) || document.getElementById('team1-row-' + matchId);
    const team2Row = document.getElementById('team2-sets-row-' + matchId) || document.getElementById('team2-row-' + matchId);
    
    // Rimuovi classi per essere sicuro se gli elementi esistono
    if (team1Row) team1Row.classList.remove('winner');
    if (team2Row) team2Row.classList.remove('winner');
    
    if (team1Score > team2Score) {
        if (team1Row) team1Row.classList.add('winner');
    } else {
        if (team2Row) team2Row.classList.add('winner');
    }
    
    const winnerTeamId = team1Score > team2Score ? team1Id : team2Id;
    
    const data = {
        match_id: matchId,
        team1_score: team1Score,
        team2_score: team2Score,
        winner_team_id: winnerTeamId
    };
    
    // Aggiungi i punteggi dei set se best of 3
    if (setScores) {
        data.set_scores = setScores;
    }
    
    fetch(`/api/tournaments/{{ tournament.id }}/elimination/update-result`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showBanner('Risultato salvato con successo!', 'success');
            
            const matchCard = document.getElementById('match-card-' + matchId);
            if(matchCard) {
                // Animazione di rimozione della card completata
                matchCard.style.transition = 'all 0.4s ease-out';
                matchCard.style.transform = 'scale(0.95)';
                matchCard.style.opacity = '0';
                matchCard.style.maxHeight = '0';
                matchCard.style.marginTop = '0';
                matchCard.style.marginBottom = '0';
                matchCard.style.padding = '0';
                matchCard.style.overflow = 'hidden';
                
                // Dopo l'animazione, rimuovi l'elemento e riorganizza
                setTimeout(() => {
                    // Ottieni la posizione della card da rimuovere
                    const cardHeight = matchCard.offsetHeight;
                    const cardTop = matchCard.offsetTop;
                    
                    // Trova tutte le card che sono sotto quella che stiamo rimuovendo
                    const allCards = Array.from(document.querySelectorAll('.match-card'));
                    const cardsBelow = allCards.filter(card => {
                        return card !== matchCard && card.offsetTop > cardTop;
                    });
                    
                    // Rimuovi la card
                    matchCard.remove();
                    
                    // Anima le card sottostanti che si spostano verso l'alto
                    cardsBelow.forEach(card => {
                        card.style.transition = 'transform 0.3s ease';
                        card.style.transform = 'translateY(-' + (cardHeight + 10) + 'px)';
                        
                        // Dopo l'animazione, resetta la trasformazione
                        setTimeout(() => {
                            card.style.transform = '';
                            card.style.transition = 'all 0.3s ease';
                        }, 300);
                    });
                    
                    // Verifica se ci sono ancora partite da completare
                    setTimeout(() => {
                        const remainingMatches = document.querySelectorAll('.match-card');
                        if (remainingMatches.length === 0) {
                            // Non ci sono più partite, ricarica per mostrare il messaggio di completamento
                            window.location.reload();
                        }
                        // Se ci sono ancora partite, non ricaricare - le card si sono riorganizzate
                    }, 350);
                }, 400);
            } else {
                // Fallback: ricarica se non trova la card
                setTimeout(() => window.location.reload(), 600);
            }
        } else {
            showBanner('Errore: ' + data.message, 'error');
            if (team1Row) team1Row.classList.remove('winner');
            if (team2Row) team2Row.classList.remove('winner');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showBanner('Errore di connessione. Riprova più tardi.', 'error');
        if (team1Row) team1Row.classList.remove('winner');
        if (team2Row) team2Row.classList.remove('winner');
    });
}

function showBanner(message, type = 'success') {
    const banner = document.getElementById('message-banner');
    const bannerText = document.getElementById('banner-text');
    const icon = banner.querySelector('i');
    
    bannerText.textContent = message;
    banner.style.display = 'flex';

    if (type === 'error') {
        banner.style.background = 'linear-gradient(135deg, #dc3545, #c82333)';
        icon.className = 'fas fa-times-circle';
    } else {
        banner.style.background = 'linear-gradient(135deg, #53a551, #4a9449)';
        icon.className = 'fas fa-check-circle';
    }
    
    // Mostra il banner
    setTimeout(() => {
        banner.style.opacity = '1';
        banner.style.transform = 'translateY(0)';
    }, 10);

    // Nascondi dopo 3 secondi
    setTimeout(() => {
        banner.style.opacity = '0';
        banner.style.transform = 'translateY(-20px)';
        setTimeout(() => banner.style.display = 'none', 300);
    }, 3000);
}

document.addEventListener('DOMContentLoaded', function() {
    // Pulisci tutti i campi punteggio per essere sicuri
    const scoreInputs = document.querySelectorAll('.score-input, .set-score-input');
    scoreInputs.forEach(input => {
        input.value = '';
    });
    
    const firstScoreInput = document.querySelector('.score-input, .set-score-input');
    if (firstScoreInput) {
        firstScoreInput.focus();
    }
});

</script>
{% endblock %}